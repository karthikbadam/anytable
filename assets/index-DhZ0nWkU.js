import{E as V,g as Z,h,S as ee,W as se,O as ae,k as C,w as b,m as ne,n as X,p,r as F,t as l,u as d,v as f,x as g,Q as c,y as q,z,B as te,o as L,D as w,F as A,G as re,H as O,I as x,K as oe,L as I,M as R,R as k,T as P,U as ie,V as U,Y as Q,Z as Y,_ as H}from"./index-DnShrW4I.js";import{$ as Ye,a0 as He,a1 as Me,a2 as Ve,a3 as Xe,a4 as ze,a5 as Ge,a6 as Je,a7 as Ke,a8 as Ze,a9 as es,aa as ss,ab as as,ac as ns,ad as ts,ae as rs,af as os,ag as is,ah as cs,ai as us,aj as ds,ak as ls,al as fs,am as bs,an as ps,ao as ys,ap as ms,aq as Ns,ar as ws,as as xs,at as hs,au as gs,a as _s,av as Ss,aw as $s,ax as As,ay as vs,az as Es,aA as Ls,aB as Os,aC as Cs,aD as js,aE as Ds,aF as Fs,aG as Rs,aH as ks,aI as Ts,aJ as qs,aK as Bs,aL as Ws,aM as Is,aN as Ps,aO as Us,aP as Qs,aQ as Ys,aR as Hs,aS as Ms,aT as Vs,aU as Xs,aV as zs,aW as Gs,aX as Js,aY as Ks,aZ as Zs,a_ as ea,a$ as sa,i as aa,b0 as na,b1 as ta,b2 as ra,b3 as oa,b4 as ia,b as ca,b5 as ua,b6 as da,b7 as la,b8 as fa,c as ba,b9 as pa,ba as ya,bb as ma,bc as Na,bd as wa,be as xa,bf as ha,bg as ga,l as _a,bh as Sa,bi as $a,bj as Aa,bk as va,bl as Ea,bm as La,bn as Oa,bo as Ca,bp as ja,bq as Da,br as Fa,bs as Ra,bt as ka,bu as Ta,bv as qa,bw as Ba,bx as Wa,by as Ia,bz as Pa,bA as Ua,bB as Qa,bC as Ya,bD as Ha,bE as Ma,bF as Va,bG as Xa,bH as za,bI as Ga,bJ as Ja,bK as Ka}from"./index-DnShrW4I.js";import{c as en,l as sn,a as an,p as nn,r as tn,s as rn,u as on}from"./string-3p-ecHfe.js";class v extends V{constructor(s=void 0,a=[],n=void 0){super(Z),this.expr=s,this._when=a,this._else=n}when(s,a){return new v(this.expr,this._when.concat(new G(h(s),h(a))),this._else)}else(s){return new v(this.expr,this._when,h(s))}toString(){return"CASE "+(this.expr?`${this.expr} `:"")+this._when.join(" ")+(this._else?` ELSE ${this._else}`:"")+" END"}}class G extends ee{constructor(s,a){super(se),this.when=s,this.then=a}toString(){return`WHEN ${this.when} THEN ${this.then}`}}class J extends V{constructor(s,a,n){super(ae),this.expr=s,this.desc=a,this.nullsFirst=n}toString(){const{expr:s,desc:a,nullsFirst:n}=this;return`${s}${a?" DESC":a===!1?" ASC":""}${n?" NULLS FIRST":n===!1?" NULLS LAST":""}`}}function ye(e,s,a){return e?new v(void 0,[new G(h(e),h(s))],h(a)):new v}function ce(e,s){return new J(h(e),!1,s)}function me(e,s){return new J(h(e),!0,s)}function Ne(e){return C("st_asgeojson",e)}function ue(e){return C("st_x",e)}function de(e){return C("st_y",e)}function K(e){return C("st_centroid",e)}function we(e){return ue(K(e))}function xe(e){return de(K(e))}function he(){return b("row_number")}function ge(){return b("rank")}function _e(){return b("dense_rank")}function Se(){return b("percent_rank")}function $e(){return b("cume_dist")}function Ae(e){return b("ntile",e)}function ve(e,s,a){return b("lag",e,s,a)}function M(e,s,a){return b("lead",e,s,a)}function Ee(e){return b("first_value",e)}function Le(e){return b("last_value",e)}function Oe(e,s){return b("nth_value",e,s)}function Ce(e){return`INSTALL ${e}; LOAD ${e}`}function le(e,{columns:s=Object.keys((e==null?void 0:e[0])||{})}={}){let a=[];if(Array.isArray(s)?(a=s,s=a.reduce((t,r)=>(t[r]=r,t),{})):s&&(a=Object.keys(s)),!a.length)throw new Error("Can not create table from empty column set.");const n=[];for(const t of e){const r=a.map(o=>`${ne(t[o])} AS "${s[o]}"`);n.push(`(SELECT ${r.join(", ")})`)}return n.join(" UNION ALL ")}function j(e,s,a,n={},t={}){const{select:r=["*"],where:o,view:i,temp:u,replace:y,...m}=n,N=fe({...t,...m}),_=`${e}('${a}'${N?", "+N:""})`,S=o?` WHERE ${o}`:"",E=`SELECT ${r.join(", ")} FROM ${_}${S}`;return X(s,E,{view:i,temp:u,replace:y})}function je(e,s,a){return j("read_csv",e,s,a,{auto_detect:!0,sample_size:-1})}function De(e,s,a){return j("read_json",e,s,a,{auto_detect:!0,format:"auto"})}function Fe(e,s,a){return j("read_parquet",e,s,a)}function Re(e,s,a={}){const{options:n,...t}=a;if(n){const r=Array.isArray(n)?n.join(", "):typeof n=="string"?n:Object.entries(n).map(([o,i])=>`${o}=${i}`).join(", ");Object.assign(t,{open_options:r.toUpperCase()})}return j("st_read",e,s,t)}function ke(e,s,a={}){const{select:n=["*"],...t}=a,r=le(s),o=n.length===1&&n[0]==="*"?r:`SELECT ${n} FROM ${r}`;return X(e,o,t)}function fe(e){return Object.entries(e).map(([s,a])=>`${s}=${T(a)}`).join(", ")}function T(e){switch(typeof e){case"boolean":return String(e);case"string":return`'${e}'`;case"undefined":case"object":return e==null?"NULL":Array.isArray(e)?"["+e.map(s=>T(s)).join(", ")+"]":"{"+Object.entries(e).map(([s,a])=>`'${s}': ${T(a)}`).join(", ")+"}";default:return e}}function Te(e,s,a,n,t){const r=t?p(a,F(e)):p(F(e),s),o=a===s?0:n/(a-s);return o?l(r,F(o)):r}function qe(e,s,a,n,t,r){return e.select({index:d(f(g(s)),l(f(g(a)),t)),...n}).groupby("index",r)}function Be(e,s,a=void 0,n=[]){const t=a?i=>l(i,a):i=>i,r=g(s),o=d(r,1);return c.from(c.unionAll(e.clone().select({i:f(r),w:t(p(o,s))}),e.clone().select({i:f(o),w:t(p(s,r))}))).select({index:"i",density:q("w")},n).groupby("index",n).having(z("density",0))}function be(e){return e}function We(e,s,a,n,t,r=[]){const o=n?$=>l($,n):be,i=($,D)=>e.clone().select({xp:s,yp:a,i:$,w:D}),u=($,D)=>d($,l(D,t)),y=f(g(s)),m=f(g(a)),N=d(y,1),_=d(m,1),S=p(s,y),E=p(N,s),B=p(a,m),W=p(_,a);return c.from(c.unionAll(i(u(y,m),o(l(E,W))),i(u(y,_),o(l(E,B))),i(u(N,m),o(l(S,W))),i(u(N,_),o(l(S,B))))).select({index:"i",density:q("w")},r).groupby("index",r).having(z("density",0))}function Ie(e,s,a,n,t,r,o=[],i=!0){e.select({x:f(g(s)),y:f(g(a))});const u=o.concat(n),y=c.from(e).select(u,{x0:"x",y0:"y",dx:p(M("x").over("sw"),"x"),dy:p(M("y").over("sw"),"y")}).window({sw:te().partitionby(u).orderby(ce("x"))}).qualify([L(w("x0",t),w(d("x0","dx"),t)),L(w("y0",r),w(d("y0","dy"),r)),L(A("x0",0),A(d("x0","dx"),0)),L(A("y0",0),A(d("y0","dy"),0))]),m=c.select({x:re(O(x("dx")),O(x("dy")))}).from("pairs"),N=c.select({i:f(oe`UNNEST(range((${m})))`)}),_=c.unionAll(c.select(u,{x:d("x0","i"),y:d("y0",f(I(R(l("i","dy"),"dx"))))}).from("pairs","indices").where([k(x("dy"),x("dx")),w("i",x("dx"))]),c.select(u,{x:d("x0",f(I(R(l(l(P("dy"),"i"),"dx"),"dy")))),y:d("y0",l(P("dy"),"i"))}).from("pairs","indices").where([A(x("dy"),x("dx")),w("i",x("dy"))]),c.select(u,{x:"x0",y:"y0"}).from("pairs").where(ie("dx"))),S=c.from("raster").select(u,"x","y",i?{w:R(1,U().partitionby(["x"].concat(u)))}:null).where([k(0,"x"),w("x",t),k(0,"y"),w("y",r)]);return c.with({pairs:y,indices:N,raster:_,points:S}).from("points").select(o,{index:d("x",l("y",f(t))),density:i?q("w"):U()}).groupby("index",o)}function Pe(e,s,a,n,t=[]){const r=f(g(s)),o=i=>c.from(e).select(i).groupby(r,t);return c.union(o([{[a]:Y(a),[n]:Q(n,a)},...t]),o([{[a]:O(a),[n]:H(n,a)},...t]),o([{[a]:Q(a,n),[n]:Y(n)},...t]),o([{[a]:H(a,n),[n]:O(n)},...t])).orderby(t,a)}export{Ye as AggregateNode,He as AndNode,Me as BetweenOpNode,Ve as BinaryOpNode,v as CaseNode,Xe as CastNode,ze as ColumnNameRefNode,Ge as ColumnParamNode,Je as ColumnRefNode,Ke as DescribeQuery,V as ExprNode,Ze as FragmentNode,es as FromClauseNode,ss as FunctionNode,as as InOpNode,ns as IntervalNode,ts as LiteralNode,rs as NotBetweenOpNode,os as OrNode,J as OrderByNode,is as ParamNode,c as Query,ee as SQLNode,cs as SampleClauseNode,us as SelectClauseNode,ds as SelectQuery,ls as SetOperation,fs as TableRefNode,bs as UnaryOpNode,ps as UnaryPosftixOpNode,ys as VerbatimNode,G as WhenNode,ms as WindowClauseNode,Ns as WindowDefNode,ws as WindowFrameNode,xs as WindowFunctionNode,hs as WindowNode,gs as WithClauseNode,x as abs,d as add,_s as and,H as argmax,Q as argmin,Ss as arrayAgg,ne as asLiteral,h as asNode,$s as asTableRef,As as asVerbatim,ce as asc,vs as avg,Te as bin1d,qe as bin2d,Be as binLinear1d,We as binLinear2d,Es as bitAnd,Ls as bitLeft,Os as bitNot,Cs as bitOr,js as bitRight,Ds as cast,Fs as ceil,K as centroid,we as centroidX,xe as centroidY,Rs as collectAggregates,ks as collectColumns,Ts as collectParams,qs as column,ye as cond,en as contains,Bs as corr,U as count,Ws as covarPop,Is as covariance,Ps as createSchema,X as createTable,$e as cume_dist,Us as dateBin,Qs as dateDay,Ys as dateMonth,Hs as dateMonthDay,_e as dense_rank,me as desc,R as div,Ms as entropy,Vs as epoch_ms,Xs as eq,zs as exp,Gs as first,Ee as first_value,Js as float32,F as float64,g as floor,Ne as geojson,re as greatest,A as gt,Ks as gte,Zs as idiv,f as int32,ea as interval,sa as isAggregateExpression,aa as isBetween,na as isColumnParam,ta as isColumnRef,ra as isDescribeQuery,oa as isDistinct,ia as isFinite,ca as isIn,ua as isInfinite,da as isNaN,la as isNode,fa as isNotBetween,ba as isNotDistinct,pa as isNotNull,ie as isNull,ya as isParamLike,ma as isQuery,Na as isSelectQuery,wa as isTableRef,xa as kurtosis,ve as lag,ha as last,Le as last_value,M as lead,ga as least,sn as length,Ie as lineDensity,_a as literal,Sa as ln,je as loadCSV,Ce as loadExtension,De as loadJSON,ke as loadObjects,Fe as loadParquet,Re as loadSpatial,$a as log,an as lower,w as lt,k as lte,Pe as m4,Aa as mad,O as max,va as median,Y as min,Ea as mod,La as mode,l as mul,z as neq,Oa as not,Oe as nth_value,Ae as ntile,L as or,te as over,Se as percent_rank,Ca as pow,nn as prefix,ja as product,Da as quantile,ge as rank,tn as regexp_matches,Fa as regrAvgX,Ra as regrAvgY,ka as regrCount,Ta as regrIntercept,qa as regrR2,Ba as regrSXX,Wa as regrSXY,Ia as regrSYY,Pa as regrSlope,Ua as rewrite,I as round,he as row_number,Qa as scaleTransform,P as sign,Ya as skewness,oe as sql,Ha as sqrt,Ma as stddev,Va as stddevPop,Xa as stringAgg,p as sub,rn as suffix,q as sum,za as trunc,on as upper,Ga as varPop,Ja as variance,Ka as walk,ue as x,de as y};
